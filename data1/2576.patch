From 4b7c3238f83b7923aeff802c51d13d5ce92b6130 Mon Sep 17 00:00:00 2001
From: Aleksandra Jovanovic <aleksandra.jovanovic@comtrade.com>
Date: Mon, 6 May 2019 13:23:18 +0200
Subject: [PATCH] Removed errors when editing Device

Signed-off-by: Aleksandra Jovanovic <aleksandra.jovanovic@comtrade.com>
---
 .../console/module/device/client/device/DeviceAddDialog.java | 5 +++--
 .../module/device/client/device/DeviceEditDialog.java        | 4 ++--
 2 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceAddDialog.java b/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceAddDialog.java
index 4c46c5fbb8a..b95ee980e2a 100644
--- a/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceAddDialog.java
+++ b/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceAddDialog.java
@@ -71,6 +71,7 @@
     protected ComboBox<GwtGroup> groupCombo;
     protected KapuaTextField<String> displayNameField;
     protected SimpleComboBox<GwtDeviceStatus> statusCombo;
+    protected FieldSet fieldSet;
 
     // Security Options fields
     // protected SimpleComboBox<String> credentialsTightCombo;
@@ -141,7 +142,7 @@ public void handleEvent(BaseEvent be) {
         };
 
         // Device general info fieldset
-        FieldSet fieldSet = new FieldSet();
+        fieldSet = new FieldSet();
         FormLayout layout = new FormLayout();
         layout.setLabelWidth(Constants.LABEL_WIDTH_DEVICE_FORM);
         fieldSet.setLayout(layout);
@@ -305,7 +306,7 @@ public int compare(GwtGroup group1, GwtGroup group2) {
     }
 
     public void validateDeviceInput() {
-        if (clientIdField.getValue() == null || displayNameField.getValue() == null || statusCombo.getValue() == null || groupCombo.getValue() == null) {
+        if (clientIdField.isVisible() && clientIdField.getValue() == null || displayNameField.getValue() == null || statusCombo.getValue() == null || groupCombo.getValue() == null) {
             ConsoleInfo.display("Error", MSGS.allFieldsRequired());
         }
     }
diff --git a/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceEditDialog.java b/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceEditDialog.java
index 4b2fa9f1d9f..540395d6a52 100644
--- a/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceEditDialog.java
+++ b/console/module/device/src/main/java/org/eclipse/kapua/app/console/module/device/client/device/DeviceEditDialog.java
@@ -38,8 +38,8 @@ public void createBody() {
         generateBody();
         submitButton.disable();
 
-        // hide fields used for add
-        clientIdField.hide();
+        // remove field used only on Add dialog
+        fieldSet.remove(clientIdField);
         // this protects against odd issue https://github.com/eclipse/kapua/issues/1631
         groupCombo.setAllowBlank(true);
 
